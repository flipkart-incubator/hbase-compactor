namespace: yak-exp-preprod
fcp:
  team: "yak"
  appId: "preprod-yak-exp"
  mail: "yak-dev"
  service: "yak-compactor-api"

mtl:
  cosmos:
    statsd: disabled
    tail: disabled
    config: cosmos
  asterix: disabled

pod:
  replicaCount: 1

hostpopulator:
  state: disabled

services:
  - name: preprod-yak-compactor
    type: LoadBalancer
    selector:
      app: yak-ui
    ports:
      - port: 8082
        targetPort: 8082
        protocol: TCP
        name: http
    LoadBalancer:
      vip: preprod-exp-yak-compactor-vip-1
      backendService: preprod-exp-yak-compactor-vip-1
      frontendPort: 80
      backendPort: 8082
      healthCheckPort: 8083
      healthCheckPath: /healthcheck
      healthCheckTimeout: 1000ms
      healthCheckInterval: 5s
      loadBalancingAlgorithm: leastconn
      doNotDeleteVip: "true"
      mode: "http"

image:
  yak-compactor:
    registry: jfrog.fkinternal.com
    repository: indradhanush/hbase-compactor-test
    tag: 0.1
    command: ["/entrypoint"]
    args: ["com.flipkart.yak.ConfigManager", "server", "/etc/hbase-compactor/config.yml"]
    volumes:
      - app
    livenessCheck:
      initialDelay: 180
      checkInterval: 15
      method: tcp
      port: 9311
    ports:
      - name: http
        containerPort: 9311
    maxCpuLimit: 1
    maxCpuAsk: 1
    maxMemoryLimit: 2Gi
    maxMemoryAsk: 2Gi
    envVarsFrom:
      - from: secret
        name: hadoop-user

volumes:
  - name: app
    type: configMap
    value: app-config
    mountPath: /etc/hbase-compactor/

configMaps:
  envName: preprod
  configs:
    - name: app-config
      source: dir
      sourceLoc: compactor
    - name: cosmos
      source: dir
      sourceLoc: cosmos
    - name: host-populator-config
      source: dir
      sourceLoc: host-populator

annotations:
  sidecar.istio.io/inject: "false"

newrelic:
  state: disabled

#secrets:
#  - name: hadoop-user
#    data:
#      - key: HADOOP_USER_NAME
#        value: eyJkYXRhIjoidmF1bHQ6djE6dU96VEhtbEc2KysybHRFS2g3RklaNGQ2bi8xaG5BV081ZzZVQ0JpMWR5NTcxVVFZIiwia2V5SWQiOiJ5YWs6OmRlZmF1bHQifQ==
#
serviceAccount:
  name: yak-compactor
  role: Role
  permissions:
    - apiGroup: ""
      resource: configmaps
      actions:
        - "get"
        - "create"
        - "update"
        - "delete"
        - "patch"
        - "list"
        - "watch"